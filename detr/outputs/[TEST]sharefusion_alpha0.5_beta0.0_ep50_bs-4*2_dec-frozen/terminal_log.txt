Logging to: DETR/detr/outputs/[TEST]sharefusion_alpha0.5_beta0.0_ep50_bs-4*2_dec-frozen/terminal_log.txt
Not using distributed mode
git:
  sha: a0df0cd96a33c3900f02aa864c6a584148d78f77, status: has uncommited changes, branch: main

Downloading: "https://download.pytorch.org/models/resnet50-0676ba61.pth" to /root/.cache/torch/hub/checkpoints/resnet50-0676ba61.pth
Downloading: "https://download.pytorch.org/models/resnet50-0676ba61.pth" to /root/.cache/torch/hub/checkpoints/resnet50-0676ba61.pth
  0%|          | 0.00/97.8M [00:00<?, ?B/s]  0%|          | 0.00/97.8M [00:00<?, ?B/s] 27%|##7       | 26.8M/97.8M [00:00<00:00, 280MB/s] 27%|##7       | 26.8M/97.8M [00:00<00:00, 280MB/s] 85%|########4 | 82.8M/97.8M [00:00<00:00, 460MB/s] 85%|########4 | 82.8M/97.8M [00:00<00:00, 460MB/s]100%|##########| 97.8M/97.8M [00:00<00:00, 453MB/s]100%|##########| 97.8M/97.8M [00:00<00:00, 453MB/s]

>>> Building RGB-D Transformer with ShareFusion...
number of params: 49717344
Using split validation dataset for train
loading annotations into memory...
Done (t=0.42s)
creating index...
index created!
Debug mode: using subset of size 100
Using split validation dataset for val
loading annotations into memory...
Done (t=0.07s)
creating index...
index created!
Debug mode: using subset of size 100
Renamed 24 keys for RGB-Stream compatibility.
>>> RGB Stream weights loaded successfully.
>>> Initializing Depth Stream from RGB weights...
>>> Depth Stream initialized.
============================================================


================================================================================
Module Name                              | Status          | Details
--------------------------------------------------------------------------------
Backbone (ResNet)                        | [90mALL FROZEN[0m | 0 / 23,454,912 params
Input Proj (RGB)                         | [90mALL FROZEN[0m | 0 / 524,544 params
Input Proj (Depth)                       | [92mALL TRAINABLE[0m | 524,544 / 524,544 params
Transformer Encoder                      | [93mPARTIAL[0m | 7,890,432 / 15,780,864 params
Transformer Decoder                      | [90mALL FROZEN[0m | 0 / 9,473,024 params
Class/BBox Head                          | [92mALL TRAINABLE[0m | 23,644 / 23,644 params
--------------------------------------------------------------------------------
Total Trainable Params: 8,438,620
================================================================================


================================================================================
Parameter Status Check:
================================================================================
RGB Encoder: 15,780,864 params, 7,890,432 trainable
Decoder: 9,473,024 params, 0 trainable
================================================================================

Start training
Traceback (most recent call last):
Traceback (most recent call last):
  File "/workspace/DETR/detr/main.py", line 529, in <module>
  File "/workspace/DETR/detr/main.py", line 529, in <module>
        main(args)main(args)

  File "/workspace/DETR/detr/main.py", line 452, in main
  File "/workspace/DETR/detr/main.py", line 452, in main
        train_stats = train_one_epoch(train_stats = train_one_epoch(

                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/workspace/DETR/detr/engine.py", line 37, in train_one_epoch
  File "/workspace/DETR/detr/engine.py", line 37, in train_one_epoch
        outputs = model(samples, samples_depth)outputs = model(samples, samples_depth)

                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
        return self._call_impl(*args, **kwargs)return self._call_impl(*args, **kwargs)

                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1562, in _call_impl
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1562, in _call_impl
        return forward_call(*args, **kwargs)return forward_call(*args, **kwargs)

                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/workspace/DETR/detr/models/detr.py", line 67, in forward
  File "/workspace/DETR/detr/models/detr.py", line 67, in forward
        features, pos = self.backbone(samples)features, pos = self.backbone(samples)

                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
        return self._call_impl(*args, **kwargs)return self._call_impl(*args, **kwargs)

                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1562, in _call_impl
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1562, in _call_impl
        return forward_call(*args, **kwargs)return forward_call(*args, **kwargs)

                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/workspace/DETR/detr/models/backbone.py", line 107, in forward
  File "/workspace/DETR/detr/models/backbone.py", line 107, in forward
        pos.append(self[1](x).to(x.tensors.dtype))pos.append(self[1](x).to(x.tensors.dtype))

                              ^^^^^^^^^^^^^^^^^^^^

  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
        return self._call_impl(*args, **kwargs)return self._call_impl(*args, **kwargs)

                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1562, in _call_impl
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1562, in _call_impl
        return forward_call(*args, **kwargs)return forward_call(*args, **kwargs)

                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/workspace/DETR/detr/models/position_encoding.py", line 40, in forward
  File "/workspace/DETR/detr/models/position_encoding.py", line 40, in forward
        dim_t = torch.arange(self.num_pos_feats, dtype=torch.float32, device=x.device)dim_t = torch.arange(self.num_pos_feats, dtype=torch.float32, device=x.device)

                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

KeyboardInterruptKeyboardInterrupt

Logging to: DETR/detr/outputs/[TEST]sharefusion_alpha0.5_beta0.0_ep50_bs-4*2_dec-frozen/terminal_log.txt
Not using distributed mode
git:
  sha: a0df0cd96a33c3900f02aa864c6a584148d78f77, status: has uncommited changes, branch: main

>>> Building RGB-D Transformer with ShareFusion...
number of params: 49717344
Using split validation dataset for train
loading annotations into memory...
Done (t=0.53s)
creating index...
index created!
Debug mode: using subset of size 100
Using split validation dataset for val
loading annotations into memory...
Done (t=0.06s)
creating index...
index created!
Debug mode: using subset of size 100
Renamed 24 keys for RGB-Stream compatibility.
>>> RGB Stream weights loaded successfully.
>>> Initializing Depth Stream from RGB weights...
>>> Depth Stream initialized.
============================================================


================================================================================
Module Name                              | Status          | Details
--------------------------------------------------------------------------------
Backbone (ResNet)                        | [90mALL FROZEN[0m | 0 / 23,454,912 params
Input Proj (RGB)                         | [90mALL FROZEN[0m | 0 / 524,544 params
Input Proj (Depth)                       | [92mALL TRAINABLE[0m | 524,544 / 524,544 params
Transformer Encoder                      | [93mPARTIAL[0m | 7,890,432 / 15,780,864 params
Transformer Decoder                      | [90mALL FROZEN[0m | 0 / 9,473,024 params
Class/BBox Head                          | [92mALL TRAINABLE[0m | 23,644 / 23,644 params
--------------------------------------------------------------------------------
Total Trainable Params: 8,438,620
================================================================================


================================================================================
Parameter Status Check:
================================================================================
RGB Encoder: 15,780,864 params, 7,890,432 trainable
Decoder: 9,473,024 params, 0 trainable
================================================================================

Start training
Epoch: [0] Total time: 0:00:06 (0.2663 s / it)
Epoch [0] Train - Loss: 15.0270, Class Error: 59.35
Test: Total time: 0:00:08 (0.3221 s / it)
Accumulating evaluation results...
DONE (t=0.19s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.300
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.478
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.313
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.082
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.313
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.483
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.277
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.425
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.457
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.134
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.451
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.685
coco_evaluator.coco_eval['bbox'].stats: [0.29972005 0.47811121 0.31292267 0.08179474 0.31256989 0.48318367
 0.27719691 0.42459936 0.45693361 0.13370523 0.45148211 0.68490597]
Epoch [0] Val - AP: 0.300, AP50: 0.478, AP75: 0.313, AR: 0.457, Loss: 10.9955
Validation score increased (-100000.000000 --> 0.299720).  Saving model ...
Training time 0:00:16
